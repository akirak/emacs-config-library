#+title: Emacs Journal
#+HUGO_SECTION: post
#+HUGO_BASE_DIR: ~/arts/github/jingsi-space-blog/
#+author: Akira Komamura
* 2019-10
** 2019-11-03 Sunday
*** Quality Assurance of Digital Life
:PROPERTIES:
:CREATED_TIME: [2019-11-02 Sat 23:59]
:END:

I have created a repository for [[https://github.com/akirak/digital-life-qa][quality assurance of my digital life]].
It is a repository for documentation on stuffs related to my digital life, and each file should correspond to one subject.
I started this project because I have felt a need for having a consistent set of policies and it should be shared with the public, no matter how competent/incompetent I am.
I am able to randomly implement some features, but without a set of well-organised plans, I am likely to lose sight of my picture.

It currently contains only one file, [[https://github.com/akirak/digital-life-qa/blob/master/emacs.org][emacs.org]], whose contents have been migrated from one of my private Org files.
The =emacs.org= document specifies the features of my Emacs configuration, which are not completely implemented at present. It describes what one's Emacs should be.
It should contain BDD test cases in a form of org-babel source blocks, which should be used to test [[https://github.com/akirak/emacs.d][my Emacs configuration]].

You can browse the contents on your web browser.
Apparently, GitHub currently lacks to support for handling links to headings with statistic cookies.

[[https://raw.githubusercontent.com/akirak/emacs-config-library/screenshots/github-org-links-to-headings-with-cookies-fs8.png]]
** 2019-10-21 Monday
*** DONE Editing Parentheses in Emacs                        :Emacs:coding:
CLOSED: [2019-10-21 Mon 20:22]
:PROPERTIES:
:CREATED_TIME: [2019-10-21 Mon 18:30]
:EXPORT_FILE_NAME: parentheses-in-emacs.md
:EXPORT_HUGO_SLUG: parentheses-in-emacs
:EXPORT_HUGO_CATEGORIES: "Emacs tips"
:END:

Before switching to Emacs, I had been using Vim.
As I do in Emacs, I used to add a bunch of plugins to my =.vimrc=.

One Vim plugin I miss in Emacs is [[https://github.com/tpope/vim-surround][surround]].
As the name implies, it is a plugin for editing parentheses and brackets.
I knew there existed Emacs packages for that purpose, but I did not think about how I want to do it until recently.

After doing some research and trying out packages, I ended up with the following plan for editing parentheses[fn:2]:

- To enclose an active region with a pair of parentheses, you can simply type ~(~ in most modes. This is supported by =electric-pair-mode=, =lispy-mode=, etc.
- To add/delete/change brackets around the point, you can use [[https://github.com/cute-jumper/embrace.el][embrace]].
  I bind ~M-i~ to =embrace-commander=, but I often forget using this command.
- To edit contents inside the surrounding quotes/brackets, you can use =sp-change-enclosing= from [[https://github.com/Fuco1/smartparens][smartparens]].
  I bind ~C-c e~ to this command[fn:1].

You can also use [[https://github.com/magnars/expand-region.el][expand-region]] for killing text inside/with a bracket pair.

Other options include [[https://github.com/casouri/isolate][isolate]] and [[https://github.com/tslilc/siege-mode][siege-mode]].
I didn't choose those packages because the configuration described above would work for most cases.

Note that this is not about editing lisp code in Emacs.
I use [[https://github.com/abo-abo/lispy][lispy]] for that purpose.

This workflow is still not as consistent as in =vim-surround=.
I must admit that vim can be more efficient than Emacs in some situations for text editing, but I am using Emacs mostly because I need an application that is capable of everything.
I want to know if there is a more elegant way to editing parentheses.
** 2019-10-14 Monday
*** org-entry-links
:PROPERTIES:
:CREATED_TIME: [2019-10-13 Sun 23:59]
:END:

I've created a new Emacs package named [[https://github.com/akirak/org-entry-links][org-entry-links]].
It is a trivial package that lets you choose a link in an entry in Org mode.

With this package, I can use Org mode as a bookmark manager.

I also have to reconfigure =org-protocol= which is a counterpart of this package:

#+begin_src dot :file static/org-entry-links.png :exports results
  digraph G {
          browser [label="Web browser"];
          org [label="Org mode"];
          browser -> org [label="org-protocol"];
          org -> browser [label="org-entry-links,\nC-c C-o,\nlink-hint, etc."];
  }
#+end_src

#+RESULTS:
[[file:static/org-entry-links.png]]

** 2019-10-13 Sunday
*** Reading list implemented as an Org agenda :Org__mode:org_agenda:reading:org_starter:
:PROPERTIES:
:CREATED_TIME: [2019-10-13 Sun 18:44]
:END:

I am currently trying to implement a reading list in a form of custom Org agenda command.
I have defined the command as follows, but it is subject to change:

#+begin_src emacs-lisp
  (defcustom akirak/org-reading-list-files
    (--> (org-agenda-files)
         ;; Add specific files
         (append
          (list
           (org-starter-locate-file "cpb.org" nil t)
           (org-starter-locate-file "learning.org" nil t))
          it)
         ;; Remove specific files
         (-difference
          it
          (list
           (org-starter-locate-file "setup.org" nil t)
           (org-starter-locate-file "devel.org" nil t)
           (org-starter-locate-file "admin.org" nil t)))
         (delq nil it)
         (cl-remove-duplicates it :test #'file-equal-p))
    "List of Org files possibly containing reading items."
    :type '(repeat file))

  (org-starter-add-block-agenda-command "r" "Reading list and research topics"
    `(org-ql-block '(tags "book" "@book" "reading" "@reading")
                   ((org-agenda-sorting-strategy '(priority-down deadline-up))
                    (org-super-agenda-groups
                     '((:todo "STARTED")
                       (:todo "NEXT")
                       (:priority "A")
                       (:todo "REVIEW")
                       (:todo "STOPPED")
                       (:name "Possibly not properly tagged. @reading is recommended"
                              :not (:tag "@reading")
                              :order -1)
                       (:priority "C" :order -2)
                       ;; TODO: Add your favourite categories here
                       (:tag "favourite" :tag "favorite")))
                    (org-agenda-files (list ,@akirak/org-reading-list-files)))))
#+end_src

My [[https://github.com/akirak/org-starter][org-starter]] package is used to define the agenda command, and I rely on =org-super-agenda= and =org-ql= packages by alphapapa.
I use =org-starter= extensively for configuring Org mode.
I must write tutorial posts on the package.

I also plan on adding another section for tracking research topics.
I am not a researcher, but topics/questions are a counterpart to sources in problem solving.
It may be useful to display both types of information in the same view.

While I was experimenting with this agenda command, I thought it would be convenient to let org-starter refresh the agenda buffer every time the agenda is redefined, so I implemented the feature: [[https://github.com/akirak/org-starter/compare/feature/refresh-agenda-buffer][feature/refresh-agenda-buffer]].
When you evaluate the agenda definition to update the definition, it refreshes an existing agenda buffer.
I will use this feature with a new =org-starter-override-agenda-window-setup= option set to =other-window=.
** 2019-10-12 Saturday
** 2019-10-07 Monday
*** Bold.el                    :Emacs:bold_el:new__package:LSP:programming:
:PROPERTIES:
:CREATED_TIME: [2019-10-07 Mon 03:29]
:END:

I've just created [[https://github.com/akirak/bold.el][bold.el]].
It can be configured like [[https://github.com/akirak/emacs.d/blob/maint/setup/setup-bold.el#L1][this]].
This is an attempt to provide a consistent set of keybindings across several programming languages by wrapping minor modes.

Language Server Protocol is supposed to serve the purpose, looks promising, and is already doing a good job for several programming languages.
However, in the Emacs world, =lsp-mode= is not the best solution for all languages.
I like =tide-mode= for TypeScript and =dante-mode= for Haskell than their LSP equivalents.
They provide partly the same features as =lsp-mode=, and I want to stick with the same keybindings whenever possible.
That is why I need to develop this wrapper package.

The package is all about muscle memory.
It doesn't provide any features in itself.
** 2019-10-05 Saturday
*** DONE Ivy-omni-org to Support Org-ql-view :Emacs:ivy_omni_org:org_ql:announcement:Org__mode:
CLOSED: [2019-10-05 Sat 22:36]
:PROPERTIES:
:CREATED_TIME: [2019-10-05 Sat 21:32]
:EXPORT_FILE_NAME: ivy-omni-org-to-integrate-with-org-ql-view.md
:EXPORT_HUGO_SLUG: ivy-omni-org-to-support-org-ql-view
:EXPORT_HUGO_CATEGORIES: "My Emacs packages"
:ID:       9d975aa0-ba66-4077-af60-7a4eddc54754
:END:

I am currently working on a feature for [[https://github.com/akirak/ivy-omni-org/][ivy-omni-org]] package to integrate with [[https://github.com/alphapapa/org-ql][org-ql]] package by alphapapa.

Ivy-omni-org is an [[https://github.com/abo-abo/swiper][Ivy]] interface which lets you choose an item from various sources on Org mode.
It currently supports the following content types:

- Org buffers
- Org files
- Org bookmarks
- Custom Org agenda commands

It also allows you to open a buffer/file/bookmark in another window/frame rather than in the current window by selecting an alternative action available from ~M-o~ key.

Org-ql is a library for searching Org entries with a query language based on S (lisp) expressions.
It also provides an alternative to =org-agenda= which lets you define agenda voews with the query language, and
=org-ql-view= library lets you manage bookmarks of such agenda views, like =org-agenda-custom-commands=.
=org-ql-view= is no more capable than =org-agenda=, but the query language is more intuitive to use than the string-based match expression syntax of =org-agenda=.

The new feature for =ivy-omni-org= lets you choose an agenda view of =org-ql-view=.
Since =org-ql-view= is an easier alternative to =org-agenda-custom-commands=, =ivy-omni-org= should provide an integration with the feature, so I implemented it.

[[https://raw.githubusercontent.com/akirak/emacs-config-library/screenshots/ivy-omni-org-with-org-ql-views.png]]

Actually, the upcoming feature is more generic: It allows you to define custom content types defined in terms of functions, and the integration with =org-ql-view= will be included in the package as an example of the customization.

The feature is not available in the master branch yet (nor from [[https://melpa.org/#/][MELPA]]) but in [[https://github.com/akirak/ivy-omni-org/tree/custom-types][this feature branch]].
Note that you can reorder the sections in =ivy-omni-org= by customizing =ivy-omni-org-content-types= to your liking.
The following is my current setup:

#+begin_src emacs-lisp
  (use-package ivy-omni-org
    :custom
    (ivy-omni-org-content-types '(agenda-commands
                                  org-ql-views
                                  buffers
                                  files
                                  bookmarks)))
#+end_src

* 2019-09
** 2019-09-29 Sunday
*** Hello
:PROPERTIES:
:CREATED_TIME: [2019-09-29 Sun 15:57]
:END:

This is the first post on my Emacs journal.
I will check how it is rendered on GitHub.

* Footnotes

[fn:2] I am not an evil user, so I did not consider any evil-based packages. 
[fn:1] To use this command in minibuffers, you need to add =smartparens-mode= to =minibuffer-setup-hook=.
